<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø±Ø­Ù„Ø© Ø§Ù„Ø´Ø±Ù‚ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠ - Ø±ÙØ§Ù‡ÙŠØ© ÙˆØ§Ø³ØªÙƒØ´Ø§Ù</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;700&family=Tajawal:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Cairo', 'Tajawal', sans-serif;
            background-color: #ffffff;
        }
        .bg-turquoise { background-color: #40E0D0; }
        .text-turquoise { color: #40E0D0; }
        .bg-gold { background-color: #FFD700; }
        .text-gold { color: #FFD700; }
        .border-gold { border-color: #FFD700; }
        .hero-section {
            background-image: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('https://images.unsplash.com/photo-1551882547-ff43c63faf76?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80');
            background-size: cover;
            background-position: center;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.9);
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- Modal for Image Carousel -->
    <div id="imageModal" class="modal flex items-center justify-center p-4" onclick="this.style.display='none'">
        <div class="max-w-4xl w-full bg-white rounded-3xl overflow-hidden shadow-2xl relative" onclick="event.stopPropagation()">
            <button class="absolute top-4 right-4 text-gray-800 text-3xl font-bold bg-white/80 w-10 h-10 rounded-full flex items-center justify-center z-20" onclick="document.getElementById('imageModal').style.display='none'">&times;</button>

            <div class="relative h-[60vh] bg-gray-200">
                <img id="modalImg" src="" class="w-full h-full object-cover transition-opacity duration-300">

                <!-- Carousel Controls -->
                <button onclick="prevImage()" class="absolute left-4 top-1/2 -translate-y-1/2 bg-white/50 hover:bg-white text-gray-800 w-12 h-12 rounded-full flex items-center justify-center text-2xl z-10">â®</button>
                <button onclick="nextImage()" class="absolute right-4 top-1/2 -translate-y-1/2 bg-white/50 hover:bg-white text-gray-800 w-12 h-12 rounded-full flex items-center justify-center text-2xl z-10">â¯</button>
            </div>

            <div class="p-8 text-center bg-white">
                <h3 id="modalTitle" class="text-2xl font-bold text-turquoise mb-2"></h3>
                <p id="imageCounter" class="text-gray-500 text-sm"></p>
            </div>
        </div>
    </div>

    <!-- Header / Nav -->
    <header class="fixed w-full z-50 bg-white/90 backdrop-blur-sm shadow-sm">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="text-2xl font-bold text-turquoise">Ø±Ø­Ù„Ø© Ø§Ù„Ø´Ø±Ù‚ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠ</div>
            <nav class="hidden md:flex space-x-reverse space-x-8">
                <a href="#features" class="hover:text-turquoise transition">Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª</a>
                <a href="#register" class="hover:text-turquoise transition">Ø³Ø¬Ù„ Ø§Ù„Ø¢Ù†</a>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero-section h-screen flex items-center justify-center text-center text-white pt-20">
        <div class="px-4">
            <h1 class="text-4xl md:text-6xl font-bold mb-6">Ø§ÙƒØªØ´Ù Ø³Ø­Ø± Ø§Ù„Ø´Ø±Ù‚ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠ</h1>
            <p class="text-xl md:text-2xl mb-10 max-w-2xl mx-auto">Ø±Ø­Ù„Ø© Ø§Ù„Ø¹Ù…Ø± Ø¨Ø§Ù†ØªØ¸Ø§Ø±Ùƒ.. Ø±ÙØ§Ù‡ÙŠØ©ØŒ Ø§Ø³ØªØ±Ø®Ø§Ø¡ØŒ ÙˆÙ…ØºØ§Ù…Ø±Ø© ÙÙŠ Ø£Ø¬Ù…Ù„ Ø´ÙˆØ§Ø·Ø¦ ÙˆØ¬Ø¨Ø§Ù„ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø± Ø§Ù„Ø´Ø±Ù‚ÙŠØ©.</p>
            <a href="#register" class="bg-gold hover:bg-yellow-500 text-gray-900 font-bold py-3 px-10 rounded-full transition transform hover:scale-105 inline-block">Ø³Ø¬Ù„ Ø§Ù„Ø¢Ù†</a>
        </div>
    </section>

    <!-- Features Section -->
    <section id="features" class="py-20 bg-gray-50">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl font-bold text-center mb-16 text-turquoise">Ù…Ø§Ø°Ø§ ÙŠÙ†ØªØ¸Ø±Ùƒ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø±Ø­Ù„Ø©ØŸ</h2>
            <div id="featuresGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-10">
                <!-- Features loaded dynamically -->
            </div>
            <p class="text-center mt-10 text-gray-500 italic">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠ Ù…ÙŠØ²Ø© Ù„Ø§Ø³ØªØ¹Ø±Ø§Ø¶ Ø£Ù„Ø¨ÙˆÙ… Ø§Ù„ØµÙˆØ±</p>
        </div>
    </section>

    <!-- Registration Form Section -->
    <section id="register" class="py-20">
        <div class="container mx-auto px-6">
            <div class="max-w-3xl mx-auto bg-white rounded-3xl shadow-2xl overflow-hidden border border-gray-100">
                <div class="bg-turquoise p-8 text-white text-center">
                    <h2 class="text-3xl font-bold">Ø§Ø­Ø¬Ø² Ù…ÙƒØ§Ù†Ùƒ Ø§Ù„Ø¢Ù†</h2>
                    <p class="mt-2">ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø±Ø© Ø¨Ø¯Ù‚Ø© ÙˆØ³Ù†ØªØµÙ„ Ø¨Ùƒ Ù‚Ø±ÙŠØ¨Ø§Ù‹</p>
                </div>
                <form id="registrationForm" class="p-8 space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-gray-700 mb-2" for="fullName">Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù„Ù‚Ø¨</label>
                            <input type="text" id="fullName" name="fullName" required class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-turquoise focus:ring-2 focus:ring-turquoise outline-none transition">
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2" for="phoneNumber">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                            <div class="relative">
                                <span class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 dir-ltr" dir="ltr">+213</span>
                                <input type="tel" id="phoneNumber" name="phoneNumber" required pattern="[567][0-9]{8}" placeholder="XXXXXXXXX" class="w-full pl-16 pr-4 py-3 rounded-xl border border-gray-300 focus:border-turquoise focus:ring-2 focus:ring-turquoise outline-none transition dir-ltr" dir="ltr">
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-gray-700 mb-2" for="birthDate">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯</label>
                            <input type="date" id="birthDate" name="birthDate" required class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-turquoise focus:ring-2 focus:ring-turquoise outline-none transition">
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">Ø§Ù„Ø¬Ù†Ø³</label>
                            <select id="gender" name="gender" required class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-turquoise focus:ring-2 focus:ring-turquoise outline-none transition">
                                <option value="">Ø§Ø®ØªØ±...</option>
                                <option value="Ø°ÙƒØ±">Ø°ÙƒØ±</option>
                                <option value="Ø£Ù†Ø«Ù‰">Ø£Ù†Ø«Ù‰</option>
                            </select>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-gray-700 mb-2" for="birthPlace">Ù…ÙƒØ§Ù† Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯</label>
                            <input type="text" id="birthPlace" name="birthPlace" required class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-turquoise focus:ring-2 focus:ring-turquoise outline-none transition">
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2" for="currentAddress">Ù…ÙƒØ§Ù† Ø§Ù„Ø³ÙƒÙ† Ø§Ù„Ø­Ø§Ù„ÙŠ</label>
                            <input type="text" id="currentAddress" name="currentAddress" required class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-turquoise focus:ring-2 focus:ring-turquoise outline-none transition">
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-gray-700 mb-2" for="jobType">Ù†ÙˆØ¹ Ø§Ù„ÙˆØ¸ÙŠÙØ©</label>
                            <input type="text" id="jobType" name="jobType" required class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-turquoise focus:ring-2 focus:ring-turquoise outline-none transition">
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">Ù‡Ù„ ØªØ¬ÙŠØ¯ Ø§Ù„Ø¥Ø³Ø¹Ø§ÙØ§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ©ØŸ</label>
                            <div class="flex space-x-reverse space-x-6 pt-3">
                                <label class="inline-flex items-center cursor-pointer">
                                    <input type="radio" name="firstAid" value="Ù†Ø¹Ù…" required class="w-5 h-5 text-turquoise focus:ring-turquoise">
                                    <span class="mr-2">Ù†Ø¹Ù…</span>
                                </label>
                                <label class="inline-flex items-center cursor-pointer">
                                    <input type="radio" name="firstAid" value="Ù„Ø§" class="w-5 h-5 text-turquoise focus:ring-turquoise">
                                    <span class="mr-2">Ù„Ø§</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <button type="submit" class="w-full bg-gold hover:bg-yellow-500 text-gray-900 font-bold py-4 rounded-xl transition transform hover:scale-[1.02]">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                </form>
                <div id="successMessage" class="hidden p-8 text-center text-green-600 font-bold">
                    <div class="text-5xl mb-4">âœ…</div>
                    ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø¨Ù†Ø¬Ø§Ø­! Ø³Ù†ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù‚Ø±ÙŠØ¨Ø§Ù‹ Ù„ØªØ£ÙƒÙŠØ¯ Ø­Ø¬Ø²Ùƒ.
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-10 text-center">
        <p>Â© 2024 Ø±Ø­Ù„Ø© Ø§Ù„Ø´Ø±Ù‚ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠ Ù„Ù„Ø³ÙŠØ§Ø­Ø© ÙˆØ§Ù„Ø£Ø³ÙØ§Ø±. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
    </footer>

    <script>
        let featureData = {};
        let currentCategory = '';
        let currentImageIndex = 0;

        async function loadFeatures() {
            const res = await fetch('/api/features');
            featureData = await res.json();
            const grid = document.getElementById('featuresGrid');
            grid.innerHTML = '';

            const icons = { hotel: 'ğŸ¨', beaches: 'ğŸ–ï¸', baths: 'ğŸ§–â€â™‚ï¸', park: 'ğŸ¢' };

            Object.entries(featureData).forEach(([key, feature]) => {
                const card = document.createElement('div');
                card.className = 'bg-white p-8 rounded-2xl shadow-lg text-center hover:shadow-xl transition cursor-pointer transform hover:-translate-y-2';
                card.onclick = () => openCarousel(key);
                card.innerHTML = `
                    <div class="text-4xl mb-4">${icons[key]}</div>
                    <h3 class="text-xl font-bold mb-3">${feature.title}</h3>
                    <p class="text-gray-600">${feature.images.length} ØµÙˆØ± Ù…ØªÙˆÙØ±Ø©</p>
                `;
                grid.appendChild(card);
            });
        }

        function openCarousel(key) {
            const feature = featureData[key];
            if (!feature.images || feature.images.length === 0) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ± Ù…ØªÙˆÙØ±Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ø­Ø§Ù„ÙŠØ§Ù‹.');
                return;
            }
            currentCategory = key;
            currentImageIndex = 0;
            updateModalContent();
            document.getElementById('imageModal').style.display = 'flex';
        }

        function updateModalContent() {
            const images = featureData[currentCategory].images;
            const imgElement = document.getElementById('modalImg');
            imgElement.style.opacity = '0';
            setTimeout(() => {
                imgElement.src = images[currentImageIndex];
                imgElement.style.opacity = '1';
            }, 200);

            document.getElementById('modalTitle').textContent = featureData[currentCategory].title;
            document.getElementById('imageCounter').textContent = `${currentImageIndex + 1} / ${images.length}`;
        }

        function nextImage() {
            const images = featureData[currentCategory].images;
            currentImageIndex = (currentImageIndex + 1) % images.length;
            updateModalContent();
        }

        function prevImage() {
            const images = featureData[currentCategory].images;
            currentImageIndex = (currentImageIndex - 1 + images.length) % images.length;
            updateModalContent();
        }

        document.getElementById('registrationForm').onsubmit = async function(e) {
            e.preventDefault();
            const formData = new FormData(this);
            const data = Object.fromEntries(formData.entries());
            data.phoneNumber = '+213' + data.phoneNumber;
            const response = await fetch('/api/register', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(data)
            });
            if (response.ok) {
                this.classList.add('hidden');
                document.getElementById('successMessage').classList.remove('hidden');
            }
        };

        loadFeatures();
    </script>
</body>
</html>
